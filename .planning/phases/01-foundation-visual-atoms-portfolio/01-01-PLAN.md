---
phase: 01-foundation-visual-atoms-portfolio
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - vite.config.js
  - .gitattributes
  - shared/eslint.config.js
  - shared/prettier.config.js
  - atoms/.gitkeep
  - dashboard/.gitkeep
  - ideas.md
autonomous: true

must_haves:
  truths:
    - "npm install succeeds with all dependencies resolved"
    - "Vite dev server starts and serves from project root"
    - "Git LFS is configured for media file types before any media commits"
    - "atoms/ directory exists as the home for all creative sketches"
  artifacts:
    - path: "package.json"
      provides: "Monorepo config with workspaces, all dependencies"
      contains: "workspaces"
    - path: "vite.config.js"
      provides: "Multi-entry Vite config auto-discovering atoms"
      contains: "defineConfig"
    - path: ".gitattributes"
      provides: "Git LFS tracking rules for media files"
      contains: "filter=lfs"
    - path: "shared/eslint.config.js"
      provides: "Shared ESLint 9 flat config"
      contains: "export default"
    - path: "shared/prettier.config.js"
      provides: "Shared Prettier config"
      contains: "export default"
  key_links:
    - from: "package.json"
      to: "cli, portfolio"
      via: "workspaces array"
      pattern: "workspaces.*cli.*portfolio"
    - from: "vite.config.js"
      to: "atoms/"
      via: "readdirSync auto-discovery"
      pattern: "readdirSync.*atoms"
---

<objective>
Set up the monorepo skeleton with npm workspaces, Vite dev server configuration, Git LFS for media assets, and shared tooling configs. This creates the foundational project structure that all subsequent plans build upon.

Purpose: Every other plan depends on this structure existing. Without package.json, no dependencies. Without Vite config, no dev server. Without Git LFS, media commits will bloat the repo.
Output: A working monorepo with `npm install` succeeding, `npx vite` starting, and Git LFS configured.
</objective>

<execution_context>
@/home/pavel/.claude/get-shit-done/workflows/execute-plan.md
@/home/pavel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-visual-atoms-portfolio/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create monorepo structure with npm workspaces and dependencies</name>
  <files>
    package.json
    atoms/.gitkeep
    dashboard/.gitkeep
    ideas.md
    .gitattributes
  </files>
  <action>
Create the monorepo root package.json with npm workspaces configuration. Use the exact structure from research:

```json
{
  "name": "eoe",
  "version": "1.0.0",
  "private": true,
  "type": "module",
  "workspaces": [
    "cli",
    "portfolio"
  ],
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^7.3.1",
    "eslint": "^9.0.0",
    "prettier": "^3.0.0"
  },
  "dependencies": {
    "p5": "^2.2.0",
    "lil-gui": "^0.21.0"
  }
}
```

Key decisions:
- `"type": "module"` for ES module support throughout (Vite requires this)
- Workspaces for `cli` and `portfolio` (separate package.json files in those dirs)
- p5 and lil-gui as root dependencies (shared across atoms)
- Do NOT include p5.capture yet (needed later for dashboard thumbnails, not for core workflow)

Create directory structure:
- `atoms/` with `.gitkeep` (will hold all creative sketches)
- `dashboard/` with `.gitkeep` (will hold dev gallery page)
- `ideas.md` with initial header:
  ```markdown
  # Ideas

  Quick-capture creative ideas. Add via `eoe note "your idea"` or edit directly.

  ---
  ```

Create `.gitattributes` for Git LFS (from research):
```
*.mp4 filter=lfs diff=lfs merge=lfs -text
*.mov filter=lfs diff=lfs merge=lfs -text
*.wav filter=lfs diff=lfs merge=lfs -text
*.mp3 filter=lfs diff=lfs merge=lfs -text
*.aiff filter=lfs diff=lfs merge=lfs -text
*.psd filter=lfs diff=lfs merge=lfs -text
*.ai filter=lfs diff=lfs merge=lfs -text
```

Then run:
```bash
git lfs install
npm install
```

Note: If `git lfs` is not installed on the system, skip the `git lfs install` command and add a note. The `.gitattributes` file will still work once LFS is installed later. Do not fail the task over this.
  </action>
  <verify>
Run `npm install` and confirm it completes without errors. Run `ls atoms/ dashboard/` to confirm directories exist. Run `cat .gitattributes` to confirm LFS config. Run `cat ideas.md` to confirm file exists with header.
  </verify>
  <done>
package.json exists with correct workspaces config, all npm dependencies install successfully, atoms/ and dashboard/ directories exist, .gitattributes has LFS tracking rules, ideas.md exists with header.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Vite multi-entry server and shared tooling</name>
  <files>
    vite.config.js
    shared/eslint.config.js
    shared/prettier.config.js
  </files>
  <action>
Create `vite.config.js` at project root. This config auto-discovers all atom folders and registers each as a build entry point. Use the pattern from research:

```javascript
import { defineConfig } from 'vite';
import { resolve } from 'path';
import { readdirSync, existsSync } from 'fs';

const atomsDir = resolve(__dirname, 'atoms');
const input = {};

// Auto-discover atoms
if (existsSync(atomsDir)) {
  const atoms = readdirSync(atomsDir, { withFileTypes: true })
    .filter(d => d.isDirectory())
    .map(d => d.name);

  atoms.forEach(atom => {
    const htmlPath = resolve(atomsDir, atom, 'index.html');
    if (existsSync(htmlPath)) {
      input[atom] = htmlPath;
    }
  });
}

// Add dashboard if exists
const dashboardHtml = resolve(__dirname, 'dashboard/index.html');
if (existsSync(dashboardHtml)) {
  input.dashboard = dashboardHtml;
}

export default defineConfig({
  build: {
    rollupOptions: {
      input: Object.keys(input).length > 0 ? input : undefined
    }
  },
  server: {
    open: '/dashboard/index.html'
  }
});
```

Key points:
- Guard all directory reads with existsSync (atoms/ may be empty initially)
- Auto-discover atom folders that have index.html
- Dashboard is the default page opened on `npx vite`
- No hardcoded atom names -- fully dynamic

Create `shared/eslint.config.js` (ESLint 9 flat config):
```javascript
export default [
  {
    files: ['**/*.js'],
    rules: {
      'no-unused-vars': 'warn',
      'no-console': 'off'
    }
  },
  {
    ignores: ['node_modules/', 'dist/', '.planning/']
  }
];
```

Create `shared/prettier.config.js`:
```javascript
export default {
  singleQuote: true,
  trailingComma: 'none',
  printWidth: 100,
  tabWidth: 2,
  semi: true
};
```

Note: Keep configs minimal. This is a creative coding project, not enterprise software. Console.log is allowed (used for config save output). Unused vars are warnings not errors (iterative creative process).
  </action>
  <verify>
Run `npx vite --help` to confirm Vite is available. Run `node -e "import('./vite.config.js').then(c => console.log('Vite config loaded:', Object.keys(c.default)))"` to confirm config is valid JS module. Check that shared/ directory has both config files.
  </verify>
  <done>
vite.config.js exists with auto-discovery of atoms and dashboard entry points. shared/eslint.config.js and shared/prettier.config.js exist with minimal creative-coding-friendly rules. `npx vite` can start without errors (will show empty dashboard since no atoms/dashboard HTML exist yet).
  </done>
</task>

</tasks>

<verification>
1. `npm install` completes without errors
2. `npx vite` starts dev server (may show 404 for dashboard -- that's expected, dashboard HTML created in Plan 04)
3. `cat .gitattributes` shows LFS tracking rules
4. `ls atoms/ dashboard/ shared/` shows directory structure exists
5. `cat package.json | grep workspaces` confirms workspace configuration
6. `cat vite.config.js` shows auto-discovery pattern
</verification>

<success_criteria>
- Monorepo structure matches research architecture (atoms/, dashboard/, shared/)
- npm install succeeds with p5, lil-gui, Vite dependencies
- Vite config auto-discovers atom folders dynamically
- Git LFS configured for media asset types
- ESLint and Prettier configs exist with creative-coding-friendly rules
- All files use ES module syntax (type: module in package.json)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-visual-atoms-portfolio/01-01-SUMMARY.md`
</output>
