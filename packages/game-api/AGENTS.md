# AGENTS (game-api)

Каноничный минимальный Game API. Любые изменения должны быть обратно совместимы.

## Каноничный минимальный game api (v1)

Базовый API живет в общем слое репозитория и доступен каждой игре из подкаталога.
Реализация — в браузере через `window.__GAME__`, без отдельного HTTP-сервера.
MCP — лишь интерфейс к нему (`window.__MCP__`).

- `window.__GAME__.getState()` — текущее состояние игры, всегда включает:
  - `version` (строка) — версия схемы состояния.
  - `status` (строка) — `ready` | `running` | `ended`.
  - `tick` (число) — счетчик изменений состояния.
  - `player` (объект) — минимум позиция/идентификатор игрока.
  - `actions` (массив) — доступные действия, минимум `id`, `label`, `enabled`.
  - `meta` (объект) — игра/уровень/seed, если применимо.
- `window.__GAME__.getActions()` — список доступных действий (может совпадать с `state.actions`).
- `window.__GAME__.act(actionId, payload?)` — выполнить действие, возвращает обновленный state.

## Правила

- Все поля в `state` должны быть сериализуемыми и стабильными между вызовами.
- Любой клик в UI соответствует `actionId` из state.
- Нельзя допускать расхождения state между UI и API (при любом действии).

## Минимальный smoke-набор

- `GET /mcp/state` возвращает валидный объект (обязательные поля выше).
- Выполнить 1–2 действия и убедиться, что изменился `tick` и состояние игрока/доступных действий.

## Где живет game api

API реализуется как общий модуль в корне репозитория (общий слой), но каждый игровой подкаталог должен иметь
тонкую обертку, чтобы запуск из подкаталога работал без ручных правок путей.
Рекомендуемый интерфейс для агентов и тестов — `window.__MCP__` (адаптер к `window.__GAME__`).
